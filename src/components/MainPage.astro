---
import { t, getMenu, type Lang } from '../i18n/utils';

interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const menuData = getMenu(lang);
---

<section class="hero">
    <img
        src="/images/restaurant-name.png"
        alt="Restaurant Name"
        class="restaurant-name-image"
    />
    <p class="moto">{t(lang, 'hero.motto')}</p>
    <p class="hours">{t(lang, 'hero.hours')}</p>
</section>

<!-- About Us -->
<section id="about-us" class="about-section content-container">
    <img
        src="/images/family.jpeg"
        alt="Restaurant Family"
        class="about-image"
    />
    <div class="about-text">
        <h2>{t(lang, 'about.title')}</h2>
        <p>{t(lang, 'about.p1')}</p>

        <h3>{t(lang, 'about.h2')}</h3>
        <p>{t(lang, 'about.p2')}</p>
        <p>{t(lang, 'about.p3')}</p>

        <h3>{t(lang, 'about.h3')}</h3>
        <p>{t(lang, 'about.p4')}</p>

        <h3>{t(lang, 'about.h4')}</h3>
        <p>{t(lang, 'about.p5')}</p>
    </div>
</section>

<!-- Parallax Section -->
<section id="menu" class="parallax">
    <div class="parallax-bg"></div>
    <div class="content">
        <h1>{t(lang, 'menu.title')}</h1>
        <h3>{t(lang, 'menu.subtitle')}</h3>
    </div>
</section>

<script>
    // Safari-compatible parallax effect using transform
    const parallaxSection = document.querySelector('.parallax');
    const parallaxBg = document.querySelector('.parallax-bg');

    if (parallaxSection && parallaxBg) {
        const updateParallax = () => {
            const rect = parallaxSection.getBoundingClientRect();
            const windowHeight = window.innerHeight;

            // Only apply effect when section is in viewport
            if (rect.bottom > 0 && rect.top < windowHeight) {
                // Calculate parallax offset - higher multiplier = stronger effect
                const scrolled = (windowHeight - rect.top) / (windowHeight + rect.height);
                const yOffset = (scrolled - 0.5) * 300;
                parallaxBg.style.transform = `translateY(${yOffset}px)`;
            }
        };

        window.addEventListener('scroll', updateParallax, { passive: true });
        window.addEventListener('resize', updateParallax, { passive: true });
        updateParallax(); // Initial call
    }
</script>

<!-- Menu -->
<section class="menu-section content-container">
    <div class="menu-columns">
        {
            menuData.map((section, index) => (
                <div
                    class="menu-column"
                    class:list-left={index % 2 === 0}
                    class:list-right={index % 2 === 1}
                >
                    <h3>{section.title}</h3>
                    <ul class="menu-category">
                        {section.items.map((item) => (
                            <li>
                                <div class="menu-item-header">
                                    <span class="dish-name">{item.name}</span>
                                    <span class="dish-price">
                                        {item.price} â‚¬
                                    </span>
                                </div>
                                <div class="menu-dots" />
                                <p class="dish-description">
                                    {item.description}
                                </p>
                            </li>
                        ))}
                    </ul>
                </div>
            ))
        }
    </div>
</section>
